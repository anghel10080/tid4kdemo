
        <!DOCTYPE html>
        <html lang="ro">
        <head>
    <link rel="stylesheet" href="../pages/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js";
    </script>
    <style>
    body, html {
    overflow-y: hidden;
    overflow-x: hidden;
    height: auto;
}
::-webkit-scrollbar {
display: none;
}
</style>

            <meta charset="UTF-8">
            <title>TID4K Avizier - Ostasilor</title>
            <meta name="infodisplay_data" content='{"id_infobox_r22":{"group":"informatii_grupa_mica_B","title":"Grupa Mica B"},"id_infobox_r23":{"group":"informatii_grupa_mijlocie_A","title":"Grupa Mijlocie A"},"id_infobox_r24":{"group":"informatii_grupa_mijlocie_B","title":"Grupa Mijlocie B"},"id_infobox_r21":{"group":"informatii_grupa_mica_A","title":"Grupa Mica A"},"id_infobox_r25":{"group":"informatii_grupa_mijlocie_C","title":"Grupa Mijlocie C"},"id_infobox_r31":{"group":"informatii_grupa_mare_A","title":"Grupa Mare A"},"id_infobox_r32":{"group":"informatii_grupa_mare_B","title":"Grupa Mare B"},"id_infobox_r33":{"group":"informatii_grupa_mare_C","title":"Grupa Mare C"},"id_infobox_r34":{"group":"informatii_grupa_mare_D","title":"Grupa Mare D"},"id_infobox_r11":{"group":"informatii_anunturi","title":"Anunțuri"},"id_infobox_r15":{"group":"informatii_meniul","title":"Meniul Săptămânii"}}'>
        </head>
        <body id="body_infodisplay">
            <header id="header_infodisplay">
                <a href="../pages/grupa_clasa_copil.php"><div id="schoolName_infodisplay">Avizier - Grădinița DEMO</div></a>
<div class="logo-qrcode-mare"><img src="../logo_mare.png" alt="Logo TID4K"><span class="logoCheckmarkPopUp">✔</span></div>            </header>
            <section id="displayArea"></section>
        <script>
document.addEventListener('DOMContentLoaded', function() {
const selections = {"id_infobox_r22":{"group":"informatii_grupa_mica_B","title":"Grupa Mica B"},"id_infobox_r23":{"group":"informatii_grupa_mijlocie_A","title":"Grupa Mijlocie A"},"id_infobox_r24":{"group":"informatii_grupa_mijlocie_B","title":"Grupa Mijlocie B"},"id_infobox_r21":{"group":"informatii_grupa_mica_A","title":"Grupa Mica A"},"id_infobox_r25":{"group":"informatii_grupa_mijlocie_C","title":"Grupa Mijlocie C"},"id_infobox_r31":{"group":"informatii_grupa_mare_A","title":"Grupa Mare A"},"id_infobox_r32":{"group":"informatii_grupa_mare_B","title":"Grupa Mare B"},"id_infobox_r33":{"group":"informatii_grupa_mare_C","title":"Grupa Mare C"},"id_infobox_r34":{"group":"informatii_grupa_mare_D","title":"Grupa Mare D"},"id_infobox_r11":{"group":"informatii_anunturi","title":"Anunțuri"},"id_infobox_r15":{"group":"informatii_meniul","title":"Meniul Săptămânii"}};
console.log('Selecții:', selections);
displayContent(document.getElementById('displayArea'), selections);
});

// Funcții auxiliare pentru evidențierea zilei curente în meniu
function adaugaZile(data, zile) {
var rezultat = new Date(data);
rezultat.setDate(rezultat.getDate() + zile);
return rezultat;
}

function obtinePrimaZiASaptamanii(data, esteWeekend) {
var zi = data.getDay();
var diferenta = zi === 0 ? -6 : 1;
var primaZi = new Date(data);
primaZi.setDate(data.getDate() - zi + diferenta);

if (esteWeekend) {
    primaZi.setDate(primaZi.getDate() + 7);
}

return primaZi;
}

function evidentiereZiCurenta() {
var dataCurenta = new Date();
var esteWeekend = dataCurenta.getDay() === 0 || dataCurenta.getDay() === 6;
var primaZi = obtinePrimaZiASaptamanii(dataCurenta, esteWeekend);

for (var i = 1; i <= 5; i++) {
    var dataZilei = adaugaZile(primaZi, i - 1);
    var dataFormatata = dataZilei.toLocaleDateString('ro-RO', { day: '2-digit', month: 'long' });
    var ziuaSaptamanii = ['Luni', 'Marți', 'Miercuri', 'Joi', 'Vineri'][i - 1];

    var th = document.querySelector(`table tr th:nth-child(${i + 1})`);
    if (th) {
        th.textContent = `${ziuaSaptamanii} (${dataFormatata})`;
}

if (!esteWeekend && i === dataCurenta.getDay()) {
    var celule = document.querySelectorAll(`table tr td:nth-child(${i + 1}), table tr th:nth-child(${i + 1})`);
    celule.forEach(function(celula) {
    celula.style.backgroundColor = '#D3D3D3';
});
}
}
}

// Observator pentru a detecta când tabelul este adăugat în DOM și a evidenția ziua curentă
const observer = new MutationObserver(function(mutations) {
if (document.querySelector('table')) {
    observer.disconnect();
    evidentiereZiCurenta();
}
});

observer.observe(document.body, { childList: true, subtree: true });

// Funcția principală pentru afișarea conținutului pe baza selecțiilor
function displayContent(displayArea, selections) {
const rowMap = {};
Object.keys(selections).forEach(id => {
const rowNumber = id.split('r')[1][0];
if (!rowMap[rowNumber]) {
    rowMap[rowNumber] = [];
}
rowMap[rowNumber].push(selections[id]);
});

const maxColumns = Math.max(...Object.values(rowMap).map(items => items.length));
displayArea.style.gridTemplateColumns = 'repeat(' + maxColumns + ', 1fr)';

Object.keys(rowMap).forEach(row => {
rowMap[row].forEach((selection, index) => {
const contentBox = document.createElement('div');
contentBox.className = selection.title === 'Meniul Săptămânii' ? 'meniuBox' : 'contentBox';
contentBox.style.gridColumnStart = index + 1;
contentBox.style.gridRowStart = parseInt(row);
displayArea.appendChild(contentBox);

const title = document.createElement('div');
title.className = 'infobox-title';
title.textContent = selection.title;
contentBox.appendChild(title);

fetchContent(selection, contentBox);
});
});
}

// Funcția pentru a prelua și afișa conținutul pentru fiecare selecție
function fetchContent(selection, container) {
const grupa = selection.group;
const titleText = selection.title;

fetch('../pages/extrage_informatii_infodisplay.php?grupa=' + grupa)
.then(response => response.json())
.then(data => {
let index = 0;
function displayFile() {
container.innerHTML = '';
const file = data[index];
const title = document.createElement('div');
title.textContent = titleText;
title.className = 'infobox-title';
container.appendChild(title);

// Procesare PDF
if (file.nume_fisier && file.nume_fisier.endsWith('.pdf')) {
    const pdfPath = file.temp_path + '/' + file.nume_fisier;
    pdfjsLib.getDocument(pdfPath).promise.then(pdfDoc => {
    pdfDoc.getPage(1).then(page => {
    const viewport = page.getViewport({ scale: 1 });
    const canvas = document.createElement('canvas');
    canvas.width = viewport.width;
    canvas.height = viewport.height;
    container.appendChild(canvas);

    const renderContext = {
    canvasContext: canvas.getContext('2d'),
    viewport: viewport
};
page.render(renderContext);
});
}).catch(err => {
console.error('Nu există astfel de documente:', err);
container.textContent = 'Nu există astfel de documente';
});
} else if (file.nume_fisier) { // Procesare imagine
    const img = document.createElement('img');
    img.src = file.temp_path + '/' + file.nume_fisier;
    img.alt = 'Imagine pentru ' + grupa;
    img.style.width = '100%';
    container.appendChild(img);
} else if (file.html) { // Procesare HTML pentru meniu
    const htmlContainer = document.createElement('div');
    htmlContainer.innerHTML = file.html;
    container.appendChild(htmlContainer);

    htmlContainer.style.width = container.clientWidth >= 2080 ? '2070px' : '100%';
    htmlContainer.style.overflow = 'auto';

    // Aplicăm CSS-ul necesar pentru HTML-ul de meniu
    const style = document.createElement('style');
    style.textContent = `
    table {
    width: 100%;
    border-collapse: collapse;
}
th, td {
border: 1px solid black;
padding: 5px;
text-align: left;
}
th {
background-color: #f2f2f2;
}
.coloana-ore {
width: 60px;
}
.inputText {
font-size: 16px;
width: 100%;
min-height: 20px;
border: none;
background-color: transparent;
resize: none;
overflow: hidden;
}`;
document.head.appendChild(style);
}

// Stilizarea containerului pentru vizualizarea uniformă
container.style.border = '4px solid #ccc';
container.style.boxShadow = '0 0 10px #666';
container.style.margin = '10px';
container.style.display = 'flex';
container.style.flexDirection = 'column';
container.style.justifyContent = 'center';
container.style.alignItems = 'center';

index = (index + 1) % data.length;
setTimeout(displayFile, file.nume_fisier && file.nume_fisier.endsWith('.pdf') ? 8000 : 5000);

evidentiereZiCurenta();
}

displayFile();
})
.catch(error => {
console.error('Nu au fost găsite documente pentru ', error);
container.textContent = '' + titleText;
});
}
</script></body>
        </html>